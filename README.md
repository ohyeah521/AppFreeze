 
# AppFreeze - 索尼安卓 TV 自动化能效优化工具 (ADB 版)

## 📖 项目背景
在索尼 Bravia 95EL 等机型上，按下遥控器电源键后系统进入的是待机（Standby）而非关机。许多第三方应用（如视频客户端、广告插件）会利用系统广播在后台持续运行，占用大量 CPU 资源并保持网络连接（有的视频客户端还会进行pcdn），导致电视发热、耗电，并可能引起下次开机时的系统卡顿。

**AppFreeze** 通过监听系统电源状态，在电视待机时利用 ADB 级别的权限自动清理用户应用，确保电视休眠时处于真正的低功耗状态。
**适用平台：** Android TV 9.0+ (Sony Bravia Optimized)，其它可以在电视上打开adb的设备理论上应该也可以，没做测试。

## 🛠 技术实现分析
本项目采用了轻量化且高权限的“非 Root 强杀”方案：

1.  **电源状态监控 (Power Management)**：
    *   通过 `AppFreezeService`（前台服务）持久化运行。
    *   注册广播接收器监听 `ACTION_SCREEN_OFF`（遥控器关机/屏幕关闭）。
2.  **包可见性与过滤 (Package Visibility)**：
    *   使用 `QUERY_ALL_PACKAGES` 权限突破 Android 11+ 的应用可见性限制。
    *   自动识别并过滤索尼系统组件（以 `com.sony.` 开头）以及核心服务，仅针对用户安装的应用进行操作。
3.  **核心清理逻辑 (The ADB "Force-Stop" Logic)**：
    *   **核心优势**：避开了无效的 `killBackgroundProcesses`，通过 ADB 授予应用权限后，调用底层 `am force-stop` 逻辑（或同等权限的 API）。
    *   **彻底性**：此操作会撤销应用的所有 JobScheduler 任务、闹钟、Service 和 Activity，彻底杜绝自启动直到用户再次手动打开。

## 🚀 主要功能
- **自动化执行**：一次配置，全程无感。关屏即杀，开屏即静。
- **前台服务保障**：通过 `FOREGROUND_SERVICE` 权限，确保清理进程不会被索尼的电源管理系统误杀。
- **开机自启**：通过 `RECEIVE_BOOT_COMPLETED` 广播，电视开机后自动启动监控服务，无需手动干预。
- **低能耗设计**：仅在屏幕状态切换瞬间触发清理，平时不占用任何 CPU 资源。

## 📦 安装与配置
### 1. 编译安装
使用 Android Studio 编译生成 APK 并通过 USB 或 ADB 安装至索尼电视。

### 2. 核心权限授权 (关键)
为了使应用能够成功执行“强行停止”，必须开启电视的 ADB，否则无法应用无法正常运行



*(注：根据具体代码实现，若使用了更高级的 shell 权限，请确保 ADB 调试已在索尼电视的“开发者选项”中开启。)*

## 📂 项目结构
- `AppFreezeService`: 核心常驻服务，负责维护通知栏前台状态及监听信号。
- `BootReceiver`: 负责接收开机广播，实现无人值守自动运行。
- `MainActivity`: 提供可视化用户界面，用于管理待清理的应用列表及服务开关。

## ⚠️ 注意事项
- **桌面说明**：请务必不要将当前正在使用的桌面加入清理列表，否则会导致无法操控设备。
- **输入法说明**：请务必不要将当前正在使用的输入法（如百度输入法、搜狗输入法 TV 版）加入清理列表，否则会导致无法输入文字。
- **投屏限制**：清理第三方投屏 App 后，待机状态下可能无法通过手机直接发现电视，需开机后重新打开应用。
- **系统安全**：本项目已在 `AndroidManifest.xml` 中配置 `leanback` 特性，完美适配索尼遥控器操作。

---
**请开发者喝一杯：** 
- ![License](https://raw.githubusercontent.com/ohyeah521/AppFreeze/refs/heads/main/Pic/buy%20me%20coffee.jpg)
